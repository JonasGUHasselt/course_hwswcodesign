<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.68.3" />
    <meta name="description" content="">


    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>203 - Coprocessor example :: HW/SW codesign</title>

    
    <link href="../../css/nucleus.css?1682322548" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1682322548" rel="stylesheet">
    <link href="../../css/hybrid.css?1682322548" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1682322548" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1682322548" rel="stylesheet">
    <link href="../../css/auto-complete.css?1682322548" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1682322548" rel="stylesheet">
    <link href="../../css/theme.css?1682322548" rel="stylesheet">
    <link href="../../css/tabs.css?1682322548" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1682322548" rel="stylesheet">
    
    <link href="../../css/theme-kul.css?1682322548" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1682322548"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script src=../../js/exercises.js></script> 
  </head>
  <body class="" data-url="/200_coprocessor/203_coproccesor_hd/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
  <img src="../../img/style/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
  <img src="../../img/style/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1682322548"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1682322548"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/course_hwswcodesign\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1682322548"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/100_processor/" title="1 Processor" class="dd-item
        
        
        
        ">
      <a href="../../100_processor/">
          1 Processor
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/100_processor/101_processor/" title="101 - Processor" class="dd-item ">
        <a href="../../100_processor/101_processor/">
        101 - Processor
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_processor/102_riscv/" title="102 - RISC-V" class="dd-item ">
        <a href="../../100_processor/102_riscv/">
        102 - RISC-V
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_processor/103_picorv/" title="103 - PicoRV32" class="dd-item ">
        <a href="../../100_processor/103_picorv/">
        103 - PicoRV32
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_processor/104_crosscomp/" title="104 - Cross compiling" class="dd-item ">
        <a href="../../100_processor/104_crosscomp/">
        104 - Cross compiling
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_processor/105_simulation/" title="105 - Simulation" class="dd-item ">
        <a href="../../100_processor/105_simulation/">
        105 - Simulation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_processor/106_exercises/" title="106 - Exercises" class="dd-item ">
        <a href="../../100_processor/106_exercises/">
        106 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/200_coprocessor/" title="2  Coprocessor" class="dd-item
        parent
        
        
        ">
      <a href="../../200_coprocessor/">
          2  Coprocessor
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/200_coprocessor/201_coprocessor/" title="201 - Coprocessor" class="dd-item ">
        <a href="../../200_coprocessor/201_coprocessor/">
        201 - Coprocessor
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/200_coprocessor/202_pcpi/" title="202 - Pico CoProcessor Interface (PCPI)" class="dd-item ">
        <a href="../../200_coprocessor/202_pcpi/">
        202 - Pico CoProcessor Interface (PCPI)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/200_coprocessor/203_coproccesor_hd/" title="203 - Coprocessor example" class="dd-item active">
        <a href="../../200_coprocessor/203_coproccesor_hd/">
        203 - Coprocessor example
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/200_coprocessor/204_exercises/" title="204 - Exercises" class="dd-item ">
        <a href="../../200_coprocessor/204_exercises/">
        204 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/300_soc/" title="3  System on Chip" class="dd-item
        
        
        
        ">
      <a href="../../300_soc/">
          3  System on Chip
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/300_soc/301_busarchs/" title="301 - Bus architectures" class="dd-item ">
        <a href="../../300_soc/301_busarchs/">
        301 - Bus architectures
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_soc/302_counter/" title="302 - Counter peripheral" class="dd-item ">
        <a href="../../300_soc/302_counter/">
        302 - Counter peripheral
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_soc/303_soc/" title="303 - System on Chip (SoC)" class="dd-item ">
        <a href="../../300_soc/303_soc/">
        303 - System on Chip (SoC)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_soc/304_exercises/" title="304 - Exercises" class="dd-item ">
        <a href="../../300_soc/304_exercises/">
        304 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/400_interrupt/" title="4  Interrupt" class="dd-item
        
        
        
        ">
      <a href="../../400_interrupt/">
          4  Interrupt
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/400_interrupt/401_interrupt/" title="401 - Interrupt" class="dd-item ">
        <a href="../../400_interrupt/401_interrupt/">
        401 - Interrupt
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_interrupt/402_handling/" title="402 - Interrupt handling" class="dd-item ">
        <a href="../../400_interrupt/402_handling/">
        402 - Interrupt handling
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_interrupt/403_example/" title="403 - Example" class="dd-item ">
        <a href="../../400_interrupt/403_example/">
        403 - Example
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_interrupt/404_exercises/" title="404 - Exercises" class="dd-item ">
        <a href="../../400_interrupt/404_exercises/">
        404 - Exercises
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/500_ascon/" title="5 ASCON" class="dd-item
        
        
        
        ">
      <a href="../../500_ascon/">
          5 ASCON
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/500_ascon/501_ascon/" title="501 ASCON" class="dd-item ">
        <a href="../../500_ascon/501_ascon/">
        501 ASCON
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_ascon/502_profiling/" title="502 Profiling" class="dd-item ">
        <a href="../../500_ascon/502_profiling/">
        502 Profiling
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_ascon/503_project/" title="503 ASCON project" class="dd-item ">
        <a href="../../500_ascon/503_project/">
        503 ASCON project
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/900_appendices/" title="9 Appendices" class="dd-item
        
        
        
        ">
      <a href="../../900_appendices/">
          9 Appendices
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/900_appendices/901_roger/" title="901 - Roger" class="dd-item ">
        <a href="../../900_appendices/901_roger/">
        901 - Roger
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://uhintra03.uhasselt.be/studiegidswww/opleidingsonderdeel.aspx?a=2022&amp;i=3468&amp;n=4&amp;t=04"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://p.cygnus.cc.kuleuven.be/webapps/blackboard/execute/announcement?method=search&amp;context=course&amp;course_id=_1128739_1"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>HWSW codesign</a> > <a href='../../200_coprocessor/'>2  Coprocessor</a> > 203 - Coprocessor example
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#coprocessor-example">Coprocessor example</a>
<ul>
<li>
<ul>
<li><a href="#control-path">Control path</a></li>
<li><a href="#data-path">Data path</a></li>
</ul></li>
</ul></li>
<li><a href="#cheating">Cheating</a></li>
<li><a href="#tadaaa">Tadaaa</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              203 - Coprocessor example
            </h1>
          

        




<h2 id="coprocessor-example">Coprocessor example</h2>

<p>As an example of a custom coprocessor a hardware component is made for calculating the Hamming distance.</p>

<p><img src="../../img/200/pcpi_hd.png" alt="hardware_hd" /></p>

<h4 id="control-path">Control path</h4>

<p>The control path is made with a <strong>set-reset flipflop</strong>. The condition for <em>setting</em> is determined by the <strong>pcpi_valid</strong> signal and the instruction. Only if the opcode in <strong>pcpi_insn</strong> is <strong>0110011</strong> and the additional opcode field (<strong>funct7</strong>) is *<em>0000001</em>, this coprocessor is targeted.</p>

<p>As long as the set-reset-flipflop is turned on, the coprocessor keeps on working. The data width is set to 32 bits, so after 32 iterations the coprocessor needs to be stopped. This is achieved by having a 32-bit register shifting in zeroes. If only a single 1-bit is present in this register, the <strong>reset</strong> should be set. This guarantees that the set-reset flipflop will be turned off <strong>in the next clock cycle</strong>.</p>

<p>While the coprocessor is running, the <strong>pcpi_wait</strong> signal is kept high. When the set-reset flipflop is reset, one clock cycle later (hence the register) the <strong>pcpi_ready</strong> and <strong>pcpi_wr</strong> signal should be high, for one clock period.</p>

<h4 id="data-path">Data path</h4>

<p>Upon activation of the coprocessor both operands <strong>pcpi_rs1</strong> and <strong>pcpi_rs2</strong> are sampled. While the processor is running, these registers shift their values out. The <em>XOR</em> of both least significant bits serves as an <strong>increment</strong> signal to a counter register. This total count register is cleared upon activation and is written out through the <strong>pcpi_rd</strong> bus.</p>

<h2 id="cheating">Cheating</h2>

<p>For this coprocessor to work, a dedicated instruction needs to be defined. Although this certainly is feasible, it is quite a cumbersome job. The compiler needs to be informed of the new instruction, which requires recompiling the cross-compiler.</p>

<p>One way to <strong>cheat</strong> our way around this is to reuse an existing instruction. <strong>The drawback of this approach is that this existing instruction can no longer be used with its original functionality.</strong></p>

<p>The code below illustrates this cheat by <em>abusing</em> the <strong>mul</strong> instruction. This was already assumed in the hardware design with parsing the <strong>pcpi_insn</strong>.</p>

<div class="multiHcolumn">
  
<div class="column">
  <p><u>In the C-code</u>, an <i>external</i> function is used. This function has to unsigned integers as parameters and also returns an unsigned integer. As this function is not coded in this file, you need to inform the compiler that this function <b>will be found</b> during linking. This is achieved with the <b>extern</b> keyword.</p>

</div>    
<div class="column">
  <p><u>In the assembly</u>, the hwswcd_hd() function is programmed. As you can see below, the only instruction this function does is the <b>mul</b> with registers a0 and a1 as operands.</p>

<p>Note the line  <code>.global hwswcd_hd</code> !! This symbol makes sure that the <b>linker</b> can find this function here.</p>

</div>    

<p></div></p>

<div class="multiHcolumn">
  
<div class="column">
  <div class="code_caption">
    firmware.c
</div>    
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;print.h&#34;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">hwswcd_hd</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> value1, <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> value2);

<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>) {
    <span style="color:#66d9ef">volatile</span> <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> value1, value2, hd;

    value1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>;
    value2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">9</span>;

    hd <span style="color:#f92672">=</span> hwswcd_hd(value1, value2);

    print_str(<span style="color:#e6db74">&#34;HD(0x&#34;</span>);
    print_hex(value1, <span style="color:#ae81ff">2</span>);
    print_str(<span style="color:#e6db74">&#34;, &#34;</span>);
    print_hex(value2, <span style="color:#ae81ff">2</span>);
    print_str(<span style="color:#e6db74">&#34;) = 0x&#34;</span>);
    print_hex(hd, <span style="color:#ae81ff">5</span>);
    print_str(<span style="color:#e6db74">&#34;.&#34;</span>);
}</code></pre></div>

<p></div><br />
<div class="column">
  <div class="code_caption">
    start.S
</div><br />
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm">  <span style="color:#a6e22e">.section</span> <span style="color:#66d9ef">.init</span>
  <span style="color:#a6e22e">.global</span> <span style="color:#66d9ef">main</span>
  <span style="color:#a6e22e">.global</span> <span style="color:#66d9ef">hwswcd_hd</span></p>

<p>start:
  <span style="color:#960050;background-color:#1e0010">/*</span> <span style="color:#a6e22e">zero-initialize</span> <span style="color:#66d9ef">all</span> <span style="color:#66d9ef">registers</span> *<span style="color:#960050;background-color:#1e0010">/</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x1</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x2</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x3</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x4</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x5</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x6</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x7</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x8</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x9</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x10</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x11</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x12</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x13</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x14</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x15</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x16</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x17</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x18</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x19</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x20</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x21</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x22</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x23</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x24</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x25</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x26</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x27</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x28</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x29</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x30</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span>
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">x31</span>, <span style="color:#66d9ef">zero</span>, <span style="color:#ae81ff">0</span></p>

<p><span style="color:#960050;background-color:#1e0010">/*</span> <span style="color:#a6e22e">set</span> <span style="color:#66d9ef">stack</span> <span style="color:#66d9ef">pointer</span> <em><span style="color:#960050;background-color:#1e0010">/</span>
  <span style="color:#a6e22e">lui</span> <span style="color:#66d9ef">sp</span>, %hi(<span style="color:#ae81ff">16</span></em><span style="color:#ae81ff">1024</span>)
  <span style="color:#a6e22e">addi</span> <span style="color:#66d9ef">sp</span>, <span style="color:#66d9ef">sp</span>, %lo(<span style="color:#ae81ff">16</span>*<span style="color:#ae81ff">1024</span>)</p>

<p><span style="color:#960050;background-color:#1e0010">/*</span> <span style="color:#a6e22e">call</span> <span style="color:#66d9ef">main</span> *<span style="color:#960050;background-color:#1e0010">/</span>
  <span style="color:#a6e22e">jal</span> <span style="color:#66d9ef">ra</span>, <span style="color:#66d9ef">main</span></p>

<p><span style="color:#960050;background-color:#1e0010">/*</span> <span style="color:#a6e22e">break</span> - <span style="color:#66d9ef">trap</span> *<span style="color:#960050;background-color:#1e0010">/</span>
  <span style="color:#a6e22e">ebreak</span></p>

<p>hwswcd_hd:
  <span style="color:#a6e22e">mul</span> <span style="color:#66d9ef">a0</span>, <span style="color:#66d9ef">a0</span>, <span style="color:#66d9ef">a1</span>
  <span style="color:#a6e22e">ret</span></code></pre></div></p>

<p></div></p>

<p></div></p>

<h2 id="tadaaa">Tadaaa</h2>

<p>You should be able to compile the binary with the code above. Don&rsquo;t forget to target the RISC-V with the <strong>multiply extension</strong> (add &rsquo;m&rsquo;) The hardware modifications that need to be made are:</p>

<ul>
<li>instantiate the component <strong>pcpi_hwswcd_hd</strong> (and not the picorv32_pcpi_mul).</li>
<li>enable the coprocessor interface <code>ENABLE_PCPI =&gt; '1'</code></li>
<li>enable the multiplication <code>ENABLE_MUL =&gt; '1'</code></li>
</ul>

<div class="centeredColumn50">
    
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">00000000000000000000000001001000</span> - <span style="color:#ae81ff">072</span> - 0x48 - H
<span style="color:#ae81ff">00000000000000000000000001000100</span> - <span style="color:#ae81ff">068</span> - 0x44 - D
<span style="color:#ae81ff">00000000000000000000000000101000</span> - <span style="color:#ae81ff">040</span> - 0x28 - <span style="color:#f92672">(</span>
<span style="color:#ae81ff">00000000000000000000000000110000</span> - <span style="color:#ae81ff">048</span> - 0x30 - <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">00000000000000000000000001111000</span> - <span style="color:#ae81ff">120</span> - 0x78 - x
<span style="color:#ae81ff">00000000000000000000000000110000</span> - <span style="color:#ae81ff">048</span> - 0x30 - <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">00000000000000000000000000110101</span> - <span style="color:#ae81ff">053</span> - 0x35 - <span style="color:#ae81ff">5</span>
<span style="color:#ae81ff">00000000000000000000000000101100</span> - <span style="color:#ae81ff">044</span> - 0x2c - ,
<span style="color:#ae81ff">00000000000000000000000000100000</span> - <span style="color:#ae81ff">032</span> - 0x20 -  
<span style="color:#ae81ff">00000000000000000000000000110000</span> - <span style="color:#ae81ff">048</span> - 0x30 - <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">00000000000000000000000000111001</span> - <span style="color:#ae81ff">057</span> - 0x39 - <span style="color:#ae81ff">9</span>
<span style="color:#ae81ff">00000000000000000000000000101001</span> - <span style="color:#ae81ff">041</span> - 0x29 - <span style="color:#f92672">)</span>
<span style="color:#ae81ff">00000000000000000000000000100000</span> - <span style="color:#ae81ff">032</span> - 0x20 -  
<span style="color:#ae81ff">00000000000000000000000000111101</span> - <span style="color:#ae81ff">061</span> - 0x3d - <span style="color:#f92672">=</span>
<span style="color:#ae81ff">00000000000000000000000000100000</span> - <span style="color:#ae81ff">032</span> - 0x20 -  
<span style="color:#ae81ff">00000000000000000000000000110000</span> - <span style="color:#ae81ff">048</span> - 0x30 - <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">00000000000000000000000001111000</span> - <span style="color:#ae81ff">120</span> - 0x78 - x
<span style="color:#ae81ff">00000000000000000000000000110000</span> - <span style="color:#ae81ff">048</span> - 0x30 - <span style="color:#ae81ff">0</span>
<span style="color:#ae81ff">00000000000000000000000000110010</span> - <span style="color:#ae81ff">050</span> - 0x32 - <span style="color:#ae81ff">2</span>
<span style="color:#ae81ff">00000000000000000000000000101110</span> - <span style="color:#ae81ff">046</span> - 0x2e - .</code></pre></div>

<p></div></p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../200_coprocessor/202_pcpi/" title="202 - Pico CoProcessor Interface (PCPI)"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../200_coprocessor/204_exercises/" title="204 - Exercises" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1682322548"></script>
    <script src="../../js/perfect-scrollbar.min.js?1682322548"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1682322548"></script>
    <script src="../../js/jquery.sticky.js?1682322548"></script>
    <script src="../../js/featherlight.min.js?1682322548"></script>
    <script src="../../js/highlight.pack.js?1682322548"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1682322548"></script>
    <script src="../../js/learn.js?1682322548"></script>
    <script src="../../js/hugo-learn.js?1682322548"></script>
    
        
            <script src="../../mermaid/mermaid.js?1682322548"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

